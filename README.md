# ClarityBlog-MatureIGA Repo

Welcome to the Clarity Blog - Mature IGA Repo! 

A few things before we get started. 

1. If you stumbled upon this repo outside of the Blog, Welcome! This repo is directly tied to a 
blog series that can be found here - https://claritysecurity.io/how-to-build-a-mature-iga/ 

2. The purpose of the blog and repo is to assist companies in developing an Identity Governance
program using python. The python scripts are extensible and robust enough to get started. However, 
these scripts are not supported by Clarity Security Corporation. If you are looking for a COTS
enterprise platform with premier support, Clarity Security is an enterprise IGA platform with prices 
starting at $2.00 / user per month. 

3. Sign up for the mailing list to receive notifications when the next chapter is published, scripts are updated, and new content
is made available - bit.ly/githubmatureiga.  

4. Watch this repo and receive a GitHub notification when commits occur.


# Project 1: Create an Identity Inventory

    Link to the blog: https://claritysecurity.io/how-to-build-a-mature-iga/

    Language(s): 
        Python 3.9 
    
    Libraries:  
        CSV - Default 
        JSON - Default
        XLSXWriter - https://pypi.org/project/XlsxWriter/
        Pandas - https://pypi.org/project/pandas/
    
    Notes: 
        IdentityInventory.py:
            Purpose: Combine disparate user listings (CSVs), generated by your applications, into a single CSV and JSON file. Each user has a single entry in the CSV and JSON, correlation occurs using full name. If you want correlation to be built around another attribute - e.g. Username or Email, change the function csvEvaluation in the following places: 
                
                Line 53 -> username or email = ''
                line 55 -> if len(headers[4]) > 1:
                line 56 -> username/email = row[headers[4][1]]
                line 57 and 58 -> delete.
                
                line 63 -> 86 ctrl h and replace fullName with username or email. 
            
            Input: CSV(s) with the following information:
                Name (Full or First and Last)
                Email / Username
                Application Name
                Manager (If able, not required)
                User Creation Date (Not required)
                User Account Status (Not required, highly recommended)
            
            Output: 2 Files:
                1 JSON file that is a json.dumps of the identity dictionary.
                1 CSV file that is the exploded identity dictionary. 
        
            Functions:
                collectFileNames(): Prompts you for the number of files and their names. Returns a list named "fileNames"
                csvEvaluation(file, identities): Processes the data in each CSV
                    Line 24 - 33 Opens the CSV
                    Line 35 - 39 Identifies the contents of each column by printing out the first value (header)
                    Line 51 - 88 Processes the contents of the file.
                        Line 55 - 61 begins populating the dictionary - identities. The dictionary structure is: 
                            Identities -> 
                                Keys -> User's Full Names
                                    Value -> Nested Dictionary ->
                                        Sub Keys -> String - Column headers (defined on line 18).
                                            Sub Values -> List of Strings -> content we are evaluating. 
                            
                            Example to fetch a sub value: 
                                print(Identities["Alexis Borchgrevink"]["Manager"]) --> ["Greg Glass", "Stephanie Burns"]
                            
                            Visualized: 
                                {'Alexis Borchgrevink': {'Manager/Reviewer': ['Greg Glass', 'Steph Burns'], 'Full Name': ['Alexis Borchgrevink'], 'First Name': ['Alexis'], 'Last Name': ['Borchgrevink'], 'Email': ['alexis@claritysecurity.io'], 'Application': ['HR AD'], 'User Creation Date': ['10/21/2022'], 'User Account Status': ['-'], 'Other': ['-'], 'Manager Response (Drop Down)': ['Employed']}
                            
                main(): Instantiates our required dictionaries, establishes the headers, and writes the final JSON file and CSV. 
    
        ManagerUserReview.py:
        
            Purpose:
            
            Input: 
            
            Output:
           
            Functions:
                collectIdentitiesFromJson(fileName, managers):
                writeManagerReviews(managers):
                managersToJson(managers):
                main():
        
    
        UserReviewCombiner.py:
        
            Purpose:
                        
            Input: 
            
            Output:
           
            Functions:
                readExcelReturnDict(fileName, responseDict):
                loadManagerJson(fileName):
                createSheetsAddHeaders(headerNames, workbook, sheetInfo):
                populateSheet(workbook, sheetName, manager, row, col, content):
                createExcel(managers):
                main():
